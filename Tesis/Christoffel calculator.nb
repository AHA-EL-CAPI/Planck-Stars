(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14247,        432]
NotebookOptionsPosition[     13747,        410]
NotebookOutlinePosition[     14081,        425]
CellTagsIndexPosition[     14038,        422]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"InverseMetric", "[", "g_", "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Inverse", "[", "g", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ChristoffelSymbol", "[", 
   RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "ig", ",", "res"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", "4"}], ";", 
     RowBox[{"ig", "=", 
      RowBox[{"InverseMetric", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"res", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ig", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "s"}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"g", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"xx", "[", 
                  RowBox[{"[", "s", "]"}], "]"}]}], "]"}]}], "+", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "s"}], "]"}], "]"}], ",", 
                RowBox[{"xx", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
                RowBox[{"xx", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"RiemannTensor", "[", 
   RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "Chr", ",", "res"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", "4"}], ";", 
     RowBox[{"Chr", "=", 
      RowBox[{"ChristoffelSymbol", "[", 
       RowBox[{"g", ",", "xx"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Chr", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "k", ",", "m"}], "]"}], "]"}], ",", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Chr", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Chr", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "s", ",", "l"}], "]"}], "]"}], "*", 
            RowBox[{"Chr", "[", 
             RowBox[{"[", 
              RowBox[{"s", ",", "k", ",", "m"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}], "-", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Chr", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "s", ",", "m"}], "]"}], "]"}], "*", 
            RowBox[{"Chr", "[", 
             RowBox[{"[", 
              RowBox[{"s", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"RicciTensor", "[", 
   RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Rie", ",", "res", ",", "n"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", "4"}], ";", 
     RowBox[{"Rie", "=", 
      RowBox[{"RiemannTensor", "[", 
       RowBox[{"g", ",", "xx"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Rie", "[", 
           RowBox[{"[", 
            RowBox[{"s", ",", "i", ",", "s", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"RicciScalar", "[", 
   RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ricc", ",", "ig", ",", "res", ",", "n"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", "4"}], ";", 
     RowBox[{"Ricc", "=", 
      RowBox[{"RicciTensor", "[", 
       RowBox[{"g", ",", "xx"}], "]"}]}], ";", 
     RowBox[{"ig", "=", 
      RowBox[{"InverseMetric", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"res", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ig", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "i"}], "]"}], "]"}], " ", 
         RowBox[{"Ricc", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "i"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.66349257477458*^9, 3.663492574793569*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xx", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           RowBox[{"\[Nu]", "[", "x", "]"}]}], ")"}]}]}], ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"\[Lambda]", "[", "x", "]"}]}], ")"}]}], ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"x", "^", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"x", "^", "2"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], "}"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.663492596550868*^9, 3.6634925965522213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RicciScalar", "[", 
  RowBox[{"g", ",", "xx"}], "]"}]], "Input",
 CellChangeTimes->{{3.6634926108453407`*^9, 3.6634926108463297`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"\[Lambda]", "[", "x", "]"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", 
       RowBox[{"\[Lambda]", "[", "x", "]"}]}]], "-", 
     RowBox[{"2", " ", "x", " ", 
      RowBox[{
       SuperscriptBox["\[Nu]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Nu]", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
     RowBox[{"x", " ", 
      RowBox[{
       SuperscriptBox["\[Lambda]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"x", " ", 
         RowBox[{
          SuperscriptBox["\[Nu]", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      RowBox[{
       SuperscriptBox["\[Nu]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], 
  SuperscriptBox["x", "2"]]], "Output",
 CellChangeTimes->{3.6634926126921663`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RicciTensor", "[", 
  RowBox[{"g", ",", "xx"}], "]"}]], "Input",
 CellChangeTimes->{{3.663492619509314*^9, 3.6634926195103083`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"\[Lambda]", "[", "x", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"\[Nu]", "[", "x", "]"}]}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"x", " ", 
             RowBox[{
              SuperscriptBox["\[Lambda]", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Nu]", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"x", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Nu]", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
         RowBox[{"x", " ", 
          RowBox[{
           SuperscriptBox["\[Nu]", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "x"], ",",
      "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Lambda]", "\[Prime]",
          MultilineFunction->None], "[", "x", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"x", " ", 
           RowBox[{
            SuperscriptBox["\[Nu]", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Nu]", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
          RowBox[{
           SuperscriptBox["\[Nu]", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}], "x"], ",",
      "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"\[Lambda]", "[", "x", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"\[Lambda]", "[", "x", "]"}]}]], "+", 
        RowBox[{"x", " ", 
         RowBox[{
          SuperscriptBox["\[Lambda]", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], "-", 
        RowBox[{"x", " ", 
         RowBox[{
          SuperscriptBox["\[Nu]", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"\[Lambda]", "[", "x", "]"}]}]], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"\[Lambda]", "[", "x", "]"}]}]], "+", 
        RowBox[{"x", " ", 
         RowBox[{
          SuperscriptBox["\[Lambda]", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], "-", 
        RowBox[{"x", " ", 
         RowBox[{
          SuperscriptBox["\[Nu]", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.663492620433249*^9}]
}, Open  ]]
},
WindowSize->{808, 621},
WindowMargins->{{204, Automatic}, {36, Automatic}},
FrontEndVersion->"10.2 for Linux x86 (64-bit) (July 6, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6631, 184, 561, "Input"],
Cell[7192, 206, 1137, 36, 99, "Input"],
Cell[CellGroupData[{
Cell[8354, 246, 158, 3, 32, "Input"],
Cell[8515, 251, 1333, 39, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9885, 295, 156, 3, 32, "Input"],
Cell[10044, 300, 3687, 107, 220, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

